<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			#arjsDebugUIContainer{ display: none!important; }
		</style>

		<script src="js/aframe.js"></script>
		<!-- <script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script> -->
		<!-- include aframe-ar.js -->
		<script src="js/aframe-ar.js"></script>
		<!-- <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/dev/aframe/build/aframe-ar.js"></script> -->
		<!-- Register an aframe component that allows reacting to marker events -->

		<script>
			AFRAME.registerComponent('registerevents', {
				init: function () {
					//this handler don't work with a-marker-camera
					var marker = this.el;
					marker.addEventListener('markerFound', function() {
						var markerId = marker.id;
						console.log('markerFound', markerId);
						// TODO: Add your own code here to react to the marker being found.
						document.querySelector("#vid").play();
					});

					marker.addEventListener('markerLost', function() {
						var markerId = marker.id;
						console.log('markerLost', markerId);
						// TODO: Add your own code here to react to the marker being lost.
						document.querySelector("#vid").pause();
					});
					// this.vidToggle = false;
					// document.querySelector("#vid").pause();
				},
				// tick: function () {
				// 	if(document.querySelector("a-marker-camera").object3D.visible == true) {
				// 		if (!this.vidToggle) {
				// 			this.vidToggle = true;
				// 			var promise = document.querySelector("#vid").play();

				// 			if (promise !== undefined) {
				// 				promise.then(_ => {
				// 					console.log('done');
				// 				// Autoplay started!
				// 			}).catch(error => {
				// 				console.log(error.message);
				// 				// Autoplay was prevented.
				// 				// Show a "Play" button so that user can start playback.
				// 			});
				// 			}

				// 			// document.querySelector("#vid").play().catch(function() {
				// 			// 	console.log('err');
				// 			// });;
				// 		}
				// 	} else {
				// 		this.vidToggle = false;
				// 		document.querySelector("#vid").pause();
				// 	}
				// }
			});
		</script>
	</head>

	<body>
		<a-scene embedded arjs='sourceType: webcam;'>
			<a-assets>
				<img id="hiroClick" src="data/HIRO_click.jpg">
			</a-assets>

			<a-marker preset='hiro' id='marker-hiro' registerevents>
				<a-image src="#hiroClick" position="0 0 0" rotation="270 0 0"></a-image>
			</a-marker>

			<a-camera position="0 -1.6 0" zoom="0"></a-camera>
		</a-scene>
	</body>
</html>
